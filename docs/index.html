<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kernelcut — Daily Tech Digest</title>
  <meta name="description" content="Kernelcut — Daily Tech Digest. Simple, readable, with long-form summaries and a 06:00 UTC newsletter." />
  <style>
    :root {
      --bg: #ffffff;
      --fg: #111111;
      --muted: #555555;
      --rule: #e6e6e6;
      --maxw: 780px;
    }
    * { box-sizing: border-box; }
    html, body { background: var(--bg); color: var(--fg); margin: 0; padding: 0; }
    body { font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    a { color: inherit; text-decoration: underline; text-underline-offset: 2px; }
    header { max-width: var(--maxw); margin: 28px auto 20px; padding: 0 16px; }
    h1 { margin: 0 0 2px; font-size: 24px; font-weight: 800; }
    .tagline { margin: 2px 0 0; color: var(--muted); font-size: 14px; font-weight: 600; letter-spacing: .02em; }
    .wrap { max-width: var(--maxw); margin: 0 auto; padding: 0 16px 48px; }
    hr { border: 0; border-top: 1px solid var(--rule); margin: 20px 0; }

    /* newsletter */
    .newsletter { margin-bottom: 24px; }
    .newsletter p { margin: 0 0 6px; color: var(--muted); font-size: 14px; }
    .nl-row { display: inline-flex; gap: 8px; align-items: center; }
    input[type="email"] {
      width: 280px; height: 36px;
      padding: 6px 10px;
      border: 1px solid var(--rule); border-radius: 6px;
      background: #fff; color: var(--fg); font-size: 14px;
    }
    button {
      height: 36px; padding: 0 12px;
      border: 1px solid var(--rule); border-radius: 6px;
      background: #fff; color: var(--fg); cursor: pointer; font-weight: 600;
    }
    button:hover { background:#f5f5f5; }
    .muted { color: var(--muted); font-size: 13px; margin-top: 4px; }

    /* sections and items */
    .section { margin: 26px 0 8px; }
    .section h3 { margin: 0; font-size: 17px; }
    .item { padding: 14px 0; border-bottom: 1px solid var(--rule); }
    .meta { margin-bottom: 6px; color: var(--muted); font-size: 13px; }
    .title { margin: 0 0 8px; font-size: 16px; font-weight: 700; line-height: 1.35; }
    .summary { margin: 0; }
  </style>
</head>
<body>
  <header>
    <h1>Kernelcut</h1>
    <p class="tagline">Daily Tech Digest</p>
  </header>

  <div class="wrap">
    <!-- newsletter -->
    <section class="newsletter" aria-labelledby="nl-title">
      <p id="nl-title">06:00 UTC — one concise email per day.</p>
      <form id="nl-form" class="nl-row" novalidate>
        <label class="sr-only" for="nl-email">Email</label>
        <input id="nl-email" name="email" type="email" placeholder="you@domain.com" required />
        <button id="nl-btn" type="submit">Subscribe</button>
      </form>
      <div id="nl-msg" class="muted" role="status"></div>
    </section>

    <hr />

    <!-- news sections -->
    <div id="sections"></div>
  </div>

  <script>
    async function loadFeed() {
      const res = await fetch('./playlist.json', { cache: 'no-store' });
      const items = await res.json();

      const categories = [
        { id: 'bigtech', name: 'Tech Titans & Upstarts', emoji: '🚀' },
        { id: 'nextfrontiers', name: 'Next Frontiers (Science & Futurism)', emoji: '🔬' },
        { id: 'code', name: 'Code & Systems', emoji: '💻' },
        { id: 'design', name: 'Design & Creativity', emoji: '🎨' },
        { id: 'ai_data', name: 'AI & Data Realities', emoji: '📊' },
        { id: 'policy', name: 'Digital Policy & Society', emoji: '🌍' },
        { id: 'fintech', name: 'Fintech & Crypto', emoji: '💸' },
        { id: 'consumer', name: 'Consumer Tech & Gadgets', emoji: '📱' },
        { id: 'space', name: 'Space & Exploration', emoji: '🛰️' }
      ];

      // group items by category
      const byCat = items.reduce((acc, it) => {
        (acc[it.category_id] ||= []).push(it); return acc;
      }, {});

      const $sections = document.getElementById('sections');
      const fmt = ts => new Date(ts).toLocaleString('en-GB', { hour12: false });

      for (const cat of categories) {
        const list = (byCat[cat.id] || []).sort((a,b)=> new Date(b.published_at) - new Date(a.published_at));
        if (!list.length) continue;

        const sec = document.createElement('section');
        sec.className = 'section';
        sec.innerHTML = `<h3>${cat.emoji} ${cat.name}</h3>`;
        $sections.appendChild(sec);

        for (const n of list) {
          const art = document.createElement('article');
          art.className = 'item';
          art.innerHTML = `
            <div class="meta">${cat.emoji} ${cat.name} • ${n.source || ''}${n.author ? ' — ' + n.author : ''} • ${fmt(n.published_at)} • ${n.region || 'Global'}</div>
            <h4 class="title"><a href="${n.url}" target="_blank" rel="noopener noreferrer">${n.title}</a></h4>
            <p class="summary">${(n.summary_long || '').replace(/\\n\\n/g, '<br><br>')}</p>
          `;
          $sections.appendChild(art);
        }
      }
    }
    loadFeed();

    // newsletter submit handler (demo)
    document.getElementById('nl-form').addEventListener('submit', e => {
      e.preventDefault();
      document.getElementById('nl-msg').textContent = "Subscribed (demo).";
    });
  </script>
</body>
</html>